<!DOCTYPE html>
<html>

<head>

	<style>
		* {
			padding: 0;
			margin: 0;
		}
		
		canvas {
			background: #CCCCCC;
			display: block;
			margin: 0 auto;
		}
	</style>

<title>Tanks</title>
</head>

<body>

	<canvas id="myCanvas" width="1300" height="630"></canvas>

	<body style="background-color:#CCCCCC;">

		<SCRIPT LANGUAGE="JavaScript">
			
			
			var canvas = document.getElementById("myCanvas");
			var ctx = canvas.getContext("2d");
			
			var maze = [[]];
			var player = [];
			var projectile = [];
			var powerUp = [];
			
			
			var index1 = 0;
			var index2 = 0;
			
			var index3 = 0;  //group index
			var stop = false;
			var noIslands = true;
			
			
			var groupEdge = [[]];  //[[x, y, leftWall]]
			
			var tileGroup = [1,0,0]; //first one is the smaller of the other two
			
			
			var players = 2;
			
			var wallWidth = 3;
			
			var maze = {width:20,height:12};
			var scale = 0.8;
			var border = {x:30,y:30};
			
			
			
			
			
			
			for(index1 = 0;index1 < 50;index1++){
				maze[index1] = [];
				for(index2 = 0;index2 < 50;index2++){
					maze[index1][index2] = {
						tile:0,
						leftWall:0,
						topWall:0,
						
						group:0
					}
				}
			}
			for(index1 = 0;index1 < players;index1++){
				player[index1] = {
					Xpos:0,
					Ypos:0,
					angle:0,
					reload:0,
					powerUp:0,
					modifier:0,
					dead:0,
					score:0,
					linkedProjectiles:0
				}
			}
			for(index1 = 0;index1 < players;index1++){
				projectile[index1] = [];
				for(index2 = 0;index2 < 100;index2++){
					projectile[index1][index2] = {
						Xpos:0,
						Ypos:0,
						Xspeed:0,
						Yspeed:0,
						size:5,
						type:0,
						dead:0,
						
						timeLeft:0
					}
				}
			}
			for(index1 = 0;index1 < 50;index1++){
				powerUp[index1] = {
					Xpos:0,
					Ypos:0,
					type:0,
					modifier:0,
					dead:0
				}
			}
			
			
			
			
			function movePlayers(){}
			function moveProjectiles(){}
			
			function drawMaze(){
				for(index1 = 0;index1 < maze.width + 2;index1++){
					for(index2 = 0;index2 < maze.height + 2;index2++){
						ctx.beginPath();
						ctx.rect(border.x + index1*50*scale, border.y + index2*50*scale, 50*scale, 50*scale);
						ctx.fillStyle = maze[index1][index2].tile == 1 ? "#CCCCCC" : "White";
						//if(maze[index1][index2].group == 1){ctx.fillStyle = "Red";}
						ctx.fill();
						ctx.closePath();
					}
				}
				for(index1 = 0;index1 < maze.width + 2;index1++){
					for(index2 = 0;index2 < maze.height + 2;index2++){
						if(maze[index1][index2].leftWall == 1){
							ctx.beginPath();
							ctx.rect(border.x + (index1*50 - wallWidth)*scale, border.y + (index2*50 - wallWidth)*scale, (wallWidth*2)*scale, (50 + wallWidth*2)*scale);
							ctx.fillStyle = "Gray";
							ctx.fill();
							ctx.closePath();
						}
						if(maze[index1][index2].topWall == 1){
							ctx.beginPath();
							ctx.rect(border.x + (index1*50 - wallWidth)*scale, border.y + (index2*50 - wallWidth)*scale, (50 + wallWidth*2)*scale, (wallWidth*2)*scale);
							ctx.fillStyle = "Gray";
							ctx.fill();
							ctx.closePath();
						}
					}
				}
			}
			function drawProjectiles(){}
			function drawTanks(){}
			function drawScores(){}  //and active powerups and modifiers
			
			
			function killPlayers(){}
			function winCheck(){}
			
			function pickUp(){}
			
			
			function shoot(player){}
			function generateMaze(){
				noIslands = false;
				while(!noIslands){
					for(index1 = 0;index1 < maze.width + 2;index1++){
						for(index2 = 0;index2 < maze.height + 2;index2++){
							if(index1 % (maze.width + 1) == 0 || index2 % (maze.height + 1) == 0){
								maze[index1][index2].tile = 1;
								maze[index1][index2].leftWall = 0;
								maze[index1][index2].topWall = 0;
							}
							else{
								maze[index1][index2].tile = Math.floor(Math.random()*1.2);
								maze[index1][index2].leftWall = Math.floor(Math.random()*2);
								maze[index1][index2].topWall = Math.floor(Math.random()*2);
							}
							maze[index1][index2].group = 0;
						}
					}
					stop = false;
					for(index1 = 1;index1 < maze.width + 1 && !stop;index1++){
						for(index2 = 1;index2 < maze.height + 1 && !stop;index2++){
							if(maze[index1][index2].tile == 0){
								maze[index1][index2].group = 1;
								stop = true;
							}
						}
					}
					stop = false;
					while(!stop){
						stop = true;
						for(index1 = 1;index1 < maze.width + 1 && stop;index1++){
							for(index2 = 1;index2 < maze.height + 1 && stop;index2++){
								if(maze[index1][index2].group != maze[index1 + 1][index2].group){
									maze[index1][index2].group = 1;
									maze[index1 + 1][index2].group = 1;
									stop = false;
								}
								if(maze[index1][index2].group != maze[index1][index2 + 1].group){
									maze[index1][index2].group = 1;
									maze[index1][index2 + 1].group = 1;
									stop = false;
								}
							}
						}
					}
					noIslands = true;
					for(index1 = 1;index1 < maze.width + 1 && !stop;index1++){
						for(index2 = 1;index2 < maze.height + 1 && !stop;index2++){
							if(maze[index1][index2].group == 0 && maze[index1][index2].tile == 0){
								noIslands = false;
								stop = true;
							}
						}
					}
				}
				for(index1 = 0;index1 < maze.width + 2;index1++){
					for(index2 = 0;index2 < maze.height + 2;index2++){
						maze[index1][index2].group = 0;
					}
				}
				
				for(index1 = 0;index1 < maze.width + 2;index1++){
					for(index2 = 0;index2 < maze.height + 2;index2++){
						if(maze[index1][index2].tile != maze[index1 + 1][index2].tile){
							maze[index1 + 1][index2].leftWall = 1;
						}
						if(maze[index1][index2].tile != maze[index1][index2 + 1].tile){
							maze[index1][index2 + 1].topWall = 1;
						}
						if(maze[index1][index2].tile + maze[index1 + 1][index2].tile == 2){
							maze[index1 + 1][index2].leftWall = 0;
						}
						if(maze[index1][index2].tile + maze[index1][index2 + 1].tile == 2){
							maze[index1][index2 + 1].topWall = 0;
						}
					}
				}
				stop = false;
				for(index1 = 1;index1 < maze.width + 1 && !stop;index1++){
					for(index2 = 1;index2 < maze.height + 1 && !stop;index2++){
						if(maze[index1][index2].tile == 0){
							maze[index1][index2].group = 1;
							stop = true;
						}
					}
				}
				stop = false;
				while(!stop){
					stop = false;
					while(!stop){
						stop = true;
						for(index1 = 1;index1 < maze.width + 1 && stop;index1++){
							for(index2 = 1;index2 < maze.height + 1 && stop;index2++){
								if(maze[index1][index2].group != maze[index1 + 1][index2].group && maze[index1 + 1][index2].leftWall == 0){
									maze[index1][index2].group = 1;
									maze[index1 + 1][index2].group = 1;
									stop = false;
								}
								if(maze[index1][index2].group != maze[index1][index2 + 1].group && maze[index1][index2 + 1].topWall == 0){
									maze[index1][index2].group = 1;
									maze[index1][index2 + 1].group = 1;
									stop = false;
								}
							}
						}
					}
					index3 = 0;
					groupEdge = [];
					for(index1 = 1;index1 < maze.width + 1;index1++){
						for(index2 = 1;index2 < maze.height + 1;index2++){
							if(maze[index1][index2].group != maze[index1 + 1][index2].group && maze[index1][index2].tile + maze[index1 + 1][index2].tile == 0){
								groupEdge[index3] = [index1 + 1, index2, "leftWall"];
								index3++;
							}
							if(maze[index1][index2].group != maze[index1][index2 + 1].group && maze[index1][index2].tile + maze[index1][index2 + 1].tile == 0){
								groupEdge[index3] = [index1, index2 + 1, "topWall"];
								index3++;
							}
						}
					}
					for(index3 = 0;index3 < groupEdge.length;index3++){
						if(Math.random() < 0.1){
							maze[groupEdge[index3][0]][groupEdge[index3][1]][groupEdge[index3][2]] = 0
						}
					}
					stop = true;
					for(index1 = 1;index1 < maze.width + 1;index1++){
						for(index2 = 1;index2 < maze.height + 1;index2++){
							if(maze[index1][index2].group + maze[index1][index2].tile == 0){
								stop = false;
							}
						}
					}
				}
				
			}
			
			
			
			
			
			addEventListener('mousemove', onMove, false);
			function onMove(evt){
				//mouse = getMousePos(canvas, evt);
			}
			document.addEventListener("click", onClick);
			function onClick(){
				
			}
			
			
			
			
			generateMaze();
			
			function draw(event) {     //=========================================================================================================================================================================================================
				
				ctx.clearRect(0, 0, canvas.width, canvas.height);
				
				
				
				
				
				
				
				
				drawMaze();
				
				
				setTimeout(draw, 20);
			}
			draw();
			
		</SCRIPT>
	</body>
</html>
