<!DOCTYPE html>
<html>

<head>

	<style>
		* {
			padding: 0;
			margin: 0;
		}
		
		canvas {
			background: black;
			display: block;
			margin: 0 auto;
		}
	</style>

<title>Gravity</title>
</head>

<body>
	
	<canvas id="myCanvas" width="1350" height="650"></canvas>
	
	<body style="background-color:black;">
		
		<SCRIPT LANGUAGE="JavaScript">
			
			
			var canvas = document.getElementById("myCanvas");
			var ctx = canvas.getContext("2d");
			
			
			var maxPlanets = 300;
			var planet = [];
			var index = 0;
			var index2 = 0;
			
			var distance = 0;
			var Xdistance = 0;
			var Ydistance = 0;
			var speed = 0;
			
			var G = 1;
			
			
			var camera = {x:0,y:0,zoom:1};
			
			var max,min = {x:0,y:0};
			//var sum = 0;
			//var count = 0;
			
			
			
			for(index = 0;index < maxPlanets;index++){
				planet[index] = {
					Xpos:Math.random()*canvas.width,
					Ypos:Math.random()*canvas.height,
					Xspeed:Math.random()*18 - 9,
					Yspeed:Math.random()*18 - 9,
					size:Math.random()*0 + 5,
					mass:0,
					color:"#b02000",
					collisions:0,
					off:0
				}
				planet[index].mass = Math.pow(planet[index].size,3);
			}
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			function draw(evt) {
				
				ctx.clearRect(0,0,canvas.width,canvas.height);
				
				
				for(index = 0;index < maxPlanets;index++){
					for(index2 = 0;index2 < maxPlanets;index2++){
						if(planet[index].off + planet[index2].off == 0){
							Xdistance = planet[index].Xpos - planet[index2].Xpos;
							Ydistance = planet[index].Ypos - planet[index2].Ypos;
							distance = Math.sqrt(Math.pow(Xdistance, 2) + Math.pow(Ydistance, 2));
							
							if(distance <= 1){speed = 0;}
							else{
								Xdistance /= distance;
								Ydistance /= distance;
								speed = G * planet[index2].mass / Math.pow(distance,2);
							}
							
							planet[index].Xspeed -= Xdistance * speed;
							planet[index].Yspeed -= Ydistance * speed;
						}
					}
				}
				
				
				
				for(index = 0;index < maxPlanets;index++){
					
					
					//collisions
					for(index2 = 0;index2 < maxPlanets;index2++){
						if(index != index2 && planet[index].off + planet[index2].off == 0){
							Xdistance = planet[index].Xpos - planet[index2].Xpos;
							Ydistance = planet[index].Ypos - planet[index2].Ypos;
							distance = Math.sqrt(Math.pow(Xdistance, 2) + Math.pow(Ydistance, 2));
							if(distance <= Math.max(planet[index].size, planet[index2].size)){
								planet[index].mass += planet[index2].mass;
								planet[index].size = Math.pow(planet[index].mass,1/3);
								planet[index].Xspeed = planet[index ].Xspeed * planet[index ].mass/(planet[index].mass + planet[index2].mass) +
										       planet[index2].Xspeed * planet[index2].mass/(planet[index].mass + planet[index2].mass);
								planet[index].Yspeed = planet[index ].Yspeed * planet[index ].mass/(planet[index].mass + planet[index2].mass) +
										       planet[index2].Yspeed * planet[index2].mass/(planet[index].mass + planet[index2].mass);
								planet[index].collisions += planet[index2].collisions + 1;
								planet[index2].off = 1;
							}
						}
					}
				}
				
				//camera
				min,max = 0;
				for(index = 0;index < maxPlanets;index++){
					if(planet[index].size >= 3){
						max.x = Math.max(max.x,planet[index].Xpos);
					}
				}
				camera.zoom = (max.x - min.x)/canvas.width;
				
				
				
				//draw
				for(index = 0;index < maxPlanets;index++){
					if(planet[index].off == 0){
						planet[index].Xpos += planet[index].Xspeed / planet[index].size;
						planet[index].Ypos += planet[index].Yspeed / planet[index].size;
						
						ctx.beginPath();
						ctx.arc(planet[index].Xpos,planet[index].Ypos,planet[index].size, 0, Math.PI * 2);
						ctx.fillStyle = "hsla(" + planet[index].collisions * 314/(maxPlanets*2) + ", 100%, 50%, 1)";//planet[index].color;
						ctx.fill();
						ctx.closePath();
					}
				}
				
				
				
				
				setTimeout(draw, 10);
			}    
			draw();
        		
   		 </SCRIPT>
	</body>
</html>
